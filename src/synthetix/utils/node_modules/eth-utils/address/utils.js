"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const secp256k1_1 = require("secp256k1");
const crypto_1 = require("../crypto");
const hex_1 = require("../hex");
const constatnts_1 = require("./constatnts");
function targetToAddress(target) {
    let result = null;
    switch (typeof target) {
        case "string":
            result = target || null;
            break;
        case "object":
            if (target && typeof target.address === "string") {
                result = target.address || null;
            }
            break;
    }
    return result;
}
exports.targetToAddress = targetToAddress;
function prepareAddress(address) {
    let result = hex_1.anyToHex(address, {
        add0x: true,
        length: 40,
    });
    if (result === constatnts_1.ZERO_ADDRESS) {
        result = null;
    }
    return result;
}
exports.prepareAddress = prepareAddress;
function publicKeyToAddress(publicKey) {
    let result = null;
    try {
        publicKey = secp256k1_1.publicKeyConvert(publicKey, false);
        if (secp256k1_1.publicKeyVerify(publicKey)) {
            result = hex_1.anyToHex(crypto_1.sha3(publicKey.slice(1)).slice(-20), {
                add0x: true,
            });
        }
    }
    catch (err) {
        result = null;
    }
    return result;
}
exports.publicKeyToAddress = publicKeyToAddress;
