"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const BN = require("bn.js");
const constants_1 = require("./constants");
function jsonReplacer(key, value) {
    const data = this[key];
    if (data instanceof Date) {
        value = {
            type: constants_1.JsonTypes.Date,
            data: data.getTime(),
        };
    }
    else if (Buffer.isBuffer(data)) {
        value = {
            type: constants_1.JsonTypes.Buffer,
            data: data.toString("hex"),
        };
    }
    else if (BN.isBN(data)) {
        value = {
            type: constants_1.JsonTypes.BN,
            data: data.toString(16),
        };
    }
    return value;
}
exports.jsonReplacer = jsonReplacer;
function jsonReviver(key, value) {
    if (value &&
        typeof value === "object" &&
        value.type) {
        switch (value.type) {
            case constants_1.JsonTypes.Buffer:
                value = Buffer.from(value.data, "hex");
                break;
            case constants_1.JsonTypes.BN:
                value = new BN(value.data, 16);
                break;
            case constants_1.JsonTypes.Date:
                value = new Date(value.data);
                break;
        }
    }
    return value;
}
exports.jsonReviver = jsonReviver;
